
alter procedure ChooseCust(
  @portK char(30)
, @amountX int
, @customerA char(30)
, @customerB char(30)
, @portL char(30)
, @portM char(30)
, @choosenCustomer char(30) output
, @choosenShip char(30) output
)

as begin

create table #SuitableShip(
  name char(30)
, cost int
, portE char(30)
)

insert into #SuitableShip
select name, cost, portE
from Ship
where portA=@portK
and capacity>=@amountX
and (portE=@portL
or portE=@portM)

select @choosenShip = name
from #SuitableShip
where cost=(select min(cost) from #SuitableShip)

if (@portL=(select portE
from #SuitableShip
where cost=(select min(cost) from #SuitableShip))) set  @choosenCustomer=@customerA
else set  @choosenCustomer=@customerA

end